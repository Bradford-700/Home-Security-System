<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet author="Sigma" id="004">
        <sql>
            CREATE TABLE photo_table(
            photo_id INT NOT NULL DEFAULT nextval('photoID_seq'),
            image bytea NOT NULL,
            deletionDate DATE,
            PRIMARY KEY (photo_id)
            );
        </sql>
        <sql>
            CREATE TABLE user_table(
            user_id INT NOT NULL DEFAULT nextval('userID_seq'),
            fname TEXT NOT NULL,
            lname TEXT NOT NULL,
            email TEXT NOT NULL,
            username TEXT NOT NULL,
            userPass TEXT NOT NULL,
            userRole roleType NOT NULL,
            profilePhoto INT NOT NULL DEFAULT 1 REFERENCES photo_table(photo_id),
            deletionDate DATE,
            PRIMARY KEY (user_id)
            );
        </sql>
        <sql>
            CREATE TABLE notification_table(
            notification_id INT NOT NULL DEFAULT nextval('notificationID_seq'),
            message TEXT NOT NULL,
            onDate DATE NOT NULL DEFAULT CURRENT_DATE,
            atTime TIME NOT NULL DEFAULT CURRENT_TIME,
            photo_id INT REFERENCES photo_Table(photo_id),
            user_id INT NOT NULL REFERENCES user_table(user_id),
            deletionDate DATE,
            PRIMARY KEY (notification_id)
            );
        </sql>
        <sql>
            CREATE TABLE person_table(
            person_id INT NOT NULL DEFAULT nextval('personID_seq'),
            fname TEXT NOT NULL,
            lname TEXT NOT NULL,
            listed listType NOT NULL DEFAULT 'Grey',
            created DATE NOT NULL DEFAULT CURRENT_DATE,
            photo_ID INT NOT NULL DEFAULT 1 REFERENCES photo_table(photo_id),
            deletionDate DATE,
            PRIMARY KEY (person_id)
            );
        </sql>
        <sql>
            CREATE TABLE vehicle_table(
            vehicle_id INT NOT NULL DEFAULT nextval('vehicleID_seq'),
            listed listType NOT NULL DEFAULT 'Grey',
            licenseNo TEXT NOT NULL,
            created DATE NOT NULL DEFAULT CURRENT_DATE,
            photo_id INT NOT NULL DEFAULT 1 REFERENCES photo_table(photo_id),
            deletionDate DATE,
            PRIMARY KEY (vehicle_id)
            );
        </sql>
        <sql>
            CREATE TABLE personvehicle_table(
            person_id INT NOT NULL REFERENCES person_Table(person_id),
            vehicle_id INT NOT NULL REFERENCES vehicle_Table(vehicle_id),
            deletionDate DATE,
            PRIMARY KEY (person_id, vehicle_id)
            );
        </sql>
    </changeSet>
</databaseChangeLog>
